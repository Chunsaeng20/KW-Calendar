<!DOCTYPE html>
<html lang="ko">
    <head>
        <!-- Meta data -->
        <meta charset="utf-8">
        <meta name="Referrer" content="origin">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="apple-mobile-web-app-title" content="KW-Calendar">
        <meta name="robots" content="index,nofollow">

        <!-- Responsive behavior -->
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Title -->
        <title>KW-Calendar</title>

        <!-- Description -->
        <meta name="description" content="광운대 학생들에게 특화된 일정 관리 웹페이지입니다.">
        <meta property="og::title" content="광운 캘린더">
        <meta property="og::url" content="">
        <meta property="og::image" content="">
        
        <!-- CSS -->
        <link rel="shortcut icon" href="" type="image/x-icon">
        <link rel="stylesheet" href="base.css">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    </head>

    <!-- Body -->
    <body style="background-color: #f8f9fd;">
        <!-- JavaScript -->
        <script src="index.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
        
        <!-- Body -->
        <section style="padding: 4rem 0;">
            <div class="container">
                <!-- Header -->
                <div class="row justify-content-center">
                    <div class="col-xl-6 text-center my-4">
                        <h2 style="font-size: 52px; color: #000;">KW - Calender</h2>
                    </div>
                </div>
                <!-- Body -->
                <div class="row">
                    <div class="col-xl-12">
                        <!-- Outer box -->
                        <div class="outer-box d-xl-flex">
                            <!-- Left side -->
                            <div class="wrap-info d-xl-flex">   
                                <div class="info">
                                    <!-- Today -->
                                    <div class="info-today">
                                        <!-- Reset button -->
                                        <p id="reset">Today</p>
                                        <!-- Today's date -->
                                        <div class="info-month">December</div>
                                        <div class="info-day">12</div>
                                    </div>
                                    <!-- Progress -->      
                                    <div class="info-progress">
                                        <div class="info-progress-heading">progress</div>
                                    </div>            
                                </div>                                                                     
                            </div>
                            <!-- Calendar -->
                            <div class="wrap-calendar">
                                <div class="wrap-button">
                                    <!-- Previous month or next month -->
                                    <button type="button" class="btn" style="float: left;"><i class="bi bi-caret-left-fill"></i></button>
                                    <div class="button-month d-inline-flex align-middle">December</div>
                                    <button type="button" class="btn" style="float: right;"><i class="bi bi-caret-right-fill"></i></button>
                                </div>
                                <table id="calendar">
                                    <!-- Day of the week -->
                                    <thead>
                                        <tr>
                                            <th style="color: crimson;">    Sun</th>
                                            <th style="color: black;">      Mon</th>
                                            <th style="color: black;">      Tue</th>
                                            <th style="color: black;">      Wed</th>
                                            <th style="color: black;">      Thu</th>
                                            <th style="color: black;">      Fri</th>
                                            <th style="color: dodgerblue;"> Sat</th>
                                        </tr>
                                    </thead>
                                    <!-- Date -->
                                    <tbody>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- Right side -->
                        <div class="wrap-tips align-items-center">
                            <div class="info p-0">                                                
                                <!-- Tips -->
                                <div class="info-tips">
                                    <div class="">Tips</div>
                                </div>                                 
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ---------------------------------------------JavaScript--------------------------------------------- -->
        <script>
        document.addEventListener('DOMContentLoaded', function () {
            // 현재 day, month 받아오기
            let currentDate = new Date();
            let currentMonth = currentDate.toLocaleString('en-US', { month: 'long' });
            let currentDay = currentDate.getDate();

            // 날짜 업데이트
            document.querySelector('.info-month').textContent = currentMonth; // info-month 업데이트
            document.querySelector('.info-day').textContent = currentDay;     // info-day 업데이트
            document.querySelector('.button-month').textContent = currentMonth + ' ' + currentDate.getFullYear(); // button-month 업데이트

            // calender body 업데이트 함수 (month의 이동이 있을 때 호출)
            function updateCalendar() {
                // 이번 달의 첫 날짜, 마지막 날짜, 시작 요일 받아오기
                let firstDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);     // 첫 날짜
                let lastDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);  // 마지막 날짜
                let startingDay = firstDate.getDay();                                               // 시작 요일

                let tableBody = document.querySelector('#calendar tbody');  // calender body 가져오기
                tableBody.innerHTML = '';                                   // calender body의 기존 text 제거
                let date = 1;                                               // date count를 위한 변수

                // row 반복문
                for (let i = 0; i < 6; i++) {
                    // td element를 받을 tr element 생성
                    let row = document.createElement('tr');

                    // coloumn 반복문
                    for (let j = 0; j < 7; j++) {
                        // 날짜를 받을 td element 생성
                        let cell = document.createElement('td');

                        // 이번달의 마지막 date를 넘었는지 확인
                        if (date > lastDate.getDate()) {
                            break;
                        }

                        // 첫번째 row에서 시작 요일 이전의 날짜는 empty 처리
                        if (i === 0 && j < startingDay) {
                            cell.textContent = '';
                        } 
                        else {
                            // td element에 현재 날짜 저장
                            cell.textContent = date;
                            date++;
                        }

                        // tr element에 td element 삽입
                        row.appendChild(cell);
                    }

                    // calender body에 td element가 정상적으로 추가된 tr element 삽입
                    tableBody.appendChild(row);
                }
            }

            // 초기 달력 업데이트
            updateCalendar();
            
            // -------------------------------------------------------------------------------------------------------

            // 'reset button'에 대한 event
            document.getElementById('reset').addEventListener('click', function () {
                // 현재 날짜로 변수 업데이트
                currentDate = new Date();
                currentMonth = currentDate.toLocaleString('en-US', { month: 'long' });
                // 화면 업데이트
                document.querySelector('.info-month').textContent = currentMonth;
                document.querySelector('.info-day').textContent = currentDay;
                document.querySelector('.button-month').textContent = currentMonth + ' ' + currentDate.getFullYear();
                updateCalendar();
            });

            // -------------------------------------------------------------------------------------------------------

            // 'Previous month button'에 대한 event
            document.querySelector('.wrap-button .btn:first-child').addEventListener('click', function () {
                // 변수 업데이트
                currentDate.setMonth(currentDate.getMonth() - 1);
                currentMonth = currentDate.toLocaleString('en-US', { month: 'long' });
                // 화면 업데이트
                document.querySelector('.button-month').textContent = currentMonth + ' ' + currentDate.getFullYear();
                updateCalendar();
            });

            // -------------------------------------------------------------------------------------------------------

            // 'Next month button'에 대한 event
            document.querySelector('.wrap-button .btn:last-child').addEventListener('click', function () {
                // 변수 업데이트
                currentDate.setMonth(currentDate.getMonth() + 1);
                currentMonth = currentDate.toLocaleString('en-US', { month: 'long' });
                // 화면 업데이트
                document.querySelector('.button-month').textContent = currentMonth + ' ' + currentDate.getFullYear();
                updateCalendar();
            });

            // -------------------------------------------------------------------------------------------------------

            // 'calender 내부의 td element'에 대한 event
            let calendarTable = document.getElementById('calendar');
            calendarTable.addEventListener('click', function (event) {
                // calender 내부의 td element에 대해서만 실행
                if (event.target.tagName === 'TD' && event.target.closest('#calendar')) {
                // 클릭된 날짜 받아오기
                let clickedDay = parseInt(event.target.textContent);

                // info-day, info-month 업데이트
                document.querySelector('.info-day').textContent = clickedDay;
                document.querySelector('.info-month').textContent = currentMonth;
                }
            });

            // -------------------------------------------------------------------------------------------------------

            // 이하 필요 기능 추가 작성.

        });
        </script>

    </body>
</html>